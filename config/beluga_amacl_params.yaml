beluga_amcl:
  ros__parameters:
    # Initial Pose
    set_initial_pose: true
    initial_pose.x: -1.3
    initial_pose.y: 0.0
    initial_pose.yaw: 0.0
    initial_pose.covariance_x: 0.25 # ±0.5m uncertainty in x (0.5² = 0.25)
    initial_pose.covariance_y: 0.25 # ±0.5m uncertainty in y
    initial_pose.covariance_yaw: 0.07 # ±15° uncertainty (~0.26 rad, 0.26² ≈ 0.07)

    # Particle filter parameters
    min_particles: 1500 # Minimum particles maintained; increase if not converging
    max_particles: 5000 # Maximum particles allowed; increase for complex/symmetric environments
    pf_err: 0.03 # Lower = more particles when uncertain; decrease for tighter tracking
    pz_z: 0.99 # Confidence level for adaptive sampling; rarely change

    # Motion model
    motion_model: omnidirectional_drive # Use omnidirectional_drive for holonomic robots
    odom_alpha1: 0.15 # Rotation noise from rotation; increase if drift during pure spin
    odom_alpha2: 0.15 # Rotation noise from translation; increase if heading drifts while driving
    odom_alpha3: 0.15 # Translation noise from translation; increase if position drifts during motion
    odom_alpha4: 0.15 # Translation noise from rotation; increase if position drifts during spin
    odom_alpha5: 0.3 # Lateral/strafe noise; critical for omnidirectional, often needs 0.3-0.5

    # Sensor model
    laser_model_type: likelihood_field # Use likelihood_field for speed, beam for accuracy
    laser_max_range: 50.0 # Maximum laser range used; set below sensor max to filter noise
    laser_min_range: 0.5 # Minimum laser range used; filters close-range noise
    max_beams: 100 # Number of beams to use; decrease for speed, increase for accuracy
    laser_likelihood_max_dist: 0.4 # Max distance from obstacles to score; increase if particles spread when stationary
    sigma_hit: 0.2 # Expected sensor noise std dev; increase for noisier sensors
    z_hit: 0.5 # Weight for correct measurements in mixture model
    z_short: 0.1 # Weight for unexpected obstacles; increase in dynamic environments
    z_max: 0.05 # Weight for max range readings
    z_rand: 0.35 # Weight for random noise; increase in cluttered/dynamic spaces

    # Update thresholds
    update_min_d: 0.1 # Minimum translation before update; lower = smoother, higher = faster
    update_min_a: 0.15 # Minimum rotation before update (radians); balance smoothness vs CPU
    resample_interval: 3 # Filter updates between resampling; keep at 2

    # Recovery parameters
    recovery_alpha_slow: 0.001 # Slow average decay; low value remembers good past longer
    recovery_alpha_fast: 0.1 # Fast average decay; high value responds to recent problems quickly

    # Spatial hashing
    spatial_resolution_x: 0.3 # Hash grid cell size for x; smaller = finer clustering, more memory
    spatial_resolution_y: 0.3 # Hash grid cell size for y; usually same as x
    spatial_resolution_theta: 5.0 # Hash grid cell size for orientation in degrees

    # Performance
    execution_policy: par # Use par for parallel execution and better performance
    transform_tolerance: 1.0 # TF buffer time in seconds; increase if TF timeout errors
    tf_broadcast: true # Publish map->odom transform; keep enabled
    always_reset_initial_pose: false # Reset particles on every initialpose message; usually keep false

    # Interface Parameters
    global_frame_id: "map"
    odom_frame_id: "odom"
    base_frame_id: "base_link"

    # Topic remapping
    scan_topic: "scan"
    map_topic: "map"
